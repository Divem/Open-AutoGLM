# Proposal: 前端交互优化 - 实时截图悬浮窗口功能

## Why

当前Web界面的实时截图功能存在用户体验问题需要优化:

1. **空间占用问题** - 截图固定在右侧面板中占用固定空间,减少了对话区域的有效显示面积
2. **视觉干扰** - 截图区域与对话内容混合显示,用户无法专注于对话交互
3. **缺乏灵活性** - 用户无法根据需要自由调整截图显示位置或大小
4. **操作不便** - 无法临时隐藏截图来获得更简洁的界面

用户需要一个更灵活、更专注的界面设计,允许根据个人偏好和使用场景调整截图显示方式。

## What Changes

### 新增功能特性

1. **悬浮截图窗口** - 将实时截图从右侧面板移至独立的悬浮窗口
2. **拖拽定位** - 支持用户自由拖拽悬浮窗口到任意位置
3. **显示/隐藏切换** - 在设置按钮旁添加切换按钮控制截图窗口显示状态
4. **智能定位** - 初始位置位于对话框右上角,避免遮挡主要内容
5. **响应式适配** - 悬浮窗口在不同屏幕尺寸下保持良好可用性

### 界面变更

**HTML结构调整**:
- 在聊天区域添加悬浮截图容器
- 在控制按钮区域添加截图切换按钮
- 保持右侧面板的截图容器作为fallback选项

**CSS样式新增**:
- 悬浮窗口的绝对定位样式
- 拖拽交互的用户界面样式
- 显示/隐藏的过渡动画效果
- 响应式断点适配

**JavaScript功能扩展**:
- 拖拽事件处理逻辑
- 切换按钮状态管理
- 窗口位置记忆功能
- 截图内容同步更新

### 技术实现

**拖拽机制**:
- 使用原生HTML5 drag API或mousedown/mousemove事件
- 支持鼠标和触摸设备的拖拽操作
- 实现边界检测防止窗口拖出视口

**状态管理**:
- localStorage存储用户偏好设置
- 记住窗口位置和显示状态
- 页面刷新后恢复用户设置

**性能优化**:
- 使用CSS transform提升拖拽性能
- 避免频繁的DOM重排和重绘
- 智能的截图更新机制

### 用户体验改进

**交互流程优化**:
1. 用户进入界面时,悬浮截图默认显示在右上角
2. 点击切换按钮可以快速隐藏/显示截图窗口
3. 拖拽窗口到舒适位置,系统记住用户偏好
4. 截图内容实时更新不影响对话操作

**可访问性支持**:
- 键盘导航支持
- 高对比度模式适配
- 屏幕阅读器兼容

**移动端适配**:
- 触摸拖拽手势支持
- 小屏幕下的智能布局调整
- 悬浮窗口最小化选项

### 兼容性保证

**向后兼容**:
- 保留原有的右侧面板截图功能
- 提供配置选项在两种模式间切换
- 不影响现有用户的使用习惯

**渐进增强**:
- 在不支持拖拽的浏览器中提供备选方案
- 优雅降级到固定位置显示
- 保持核心截图功能可用

### 影响范围

**前端文件修改**:
- `web/templates/index.html` - HTML结构调整
- `web/static/css/style.css` - 样式扩展
- `web/static/js/app.js` - JavaScript功能增强

**无后端影响**:
- 纯前端优化,不涉及API变更
- 不影响服务端架构和数据处理
- 与现有WebSocket通信完全兼容

### 配置选项

提供用户可配置的选项:
- 悬浮模式 vs 面板模式选择
- 窗口透明度调节
- 截图缩放比例设置
- 自动隐藏时间设置